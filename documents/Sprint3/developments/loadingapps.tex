\subsection{Loading Applications}\label{sect:sprint3:refactoring}
In the new \lstinline!SettingsActivity!, described in \cref{sec:sprint3:settings}, \launcher will load applications alike it does in \lstinline|HomeActivity|.
However, the methods that load applications into a given view are placed in \lstinline!HomeActivity!.
Therefore, it is needed to refactor much of the existing code, so \launcher can load applications from any given activity.\\

We refactor \lstinline!HomeActivity! by moving the relevant methods, most prominently the \lstinline|loadApplications()| method, into \lstinline!LauncherUtility!.
Then both activities can call the same methods and code redundancy is reduced. 
However, \lstinline|loadApplications()| needed to be changed further, to accommodate the different usages in the home activity and the settings activity. It was required to pass different callback methods since the behaviour was not the same. The ``Apps" pane requires the applications to be marked when pressed, while the home activity requires the applications to launch.

Furthermore, the code was in several case supplemented with additional functionality.

\subsubsection{Observing New Applications}\label{sec:sprint3:observing}
To increase usability when installing or removing applications on the device, we create an observer which has the responsible to keep an eye on currently installed applications and compare these with those which are shown at that moment. 
If there for example are new applications on the device, which are not on the list of currently loaded applications they are reloaded, by calling the \lstinline|loadApplications()| method described above.

This functionality is implemented creating a custom timer task by extending the Java class \lstinline!TimerTask! and scheduling this custom task to run at a fixed interval. 
Thus a check is made every fifth second to see if any new applications have been installed.
The interval is decided after we found acceptable.

For every execution of the custom task, a list of installed applications is retried and compared with a list of currently loaded applications. 
If the two lists differ, the applications are reloaded and the list of currently loaded applications is updated.